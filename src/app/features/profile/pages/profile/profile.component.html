<div class="profile-container">
  <div class="profile-card">
    <div class="profile-header">
      <div class="avatar">
        <img *ngIf="user()?.avatar" [src]="user()?.avatar" [alt]="user()?.username">
        <div *ngIf="!user()?.avatar" class="avatar-placeholder">
          {{ user()?.username?.charAt(0)?.toUpperCase() }}
        </div>
      </div>
      <h1>{{ user()?.username }}</h1>
    </div>

    <div *ngIf="loading()" class="loading">
      Loading profile...
    </div>

    <form *ngIf="!loading()" [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="profile-form">
      <div class="form-group">
        <label for="email">Email</label>
        <input 
          type="email" 
          id="email" 
          formControlName="email" 
          placeholder="Enter your email"
          [class.error]="email?.invalid && email?.touched">
        <span *ngIf="email?.invalid && email?.touched" class="error-message">
          <span *ngIf="email?.errors?.['required']">Email is required</span>
          <span *ngIf="email?.errors?.['email']">Please enter a valid email</span>
        </span>
      </div>

      <div class="form-group">
        <label for="username">Username</label>
        <input 
          type="text" 
          id="username" 
          formControlName="username" 
          placeholder="Enter your username"
          [class.error]="username?.invalid && username?.touched">
        <span *ngIf="username?.invalid && username?.touched" class="error-message">
          <span *ngIf="username?.errors?.['required']">Username is required</span>
          <span *ngIf="username?.errors?.['minlength']">Username must be at least 3 characters</span>
        </span>
      </div>

      <div class="form-group">
        <label for="avatar">Avatar URL</label>
        <input 
          type="url" 
          id="avatar" 
          formControlName="avatar" 
          placeholder="https://example.com/avatar.jpg">
      </div>

      <div *ngIf="error()" class="alert alert-error">
        {{ error() }}
      </div>

      <div *ngIf="success()" class="alert alert-success">
        {{ success() }}
      </div>

      <div class="form-actions">
        <button 
          type="submit" 
          class="btn btn-primary" 
          [disabled]="profileForm.invalid || saving()">
          <span *ngIf="saving()">Saving...</span>
          <span *ngIf="!saving()">Save Changes</span>
        </button>
        <button type="button" class="btn btn-danger" (click)="logout()">
          Logout
        </button>
      </div>
    </form>
  </div>
</div>